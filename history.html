<!-- history.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking History - Parcel Management</title>
    <link rel="stylesheet" href="styles.css">
    <script src="scripts.js" defer></script>
</head>
<body>
    <div class="topbar">
        <p class="welcome">Hello, <span id="displayUser">User</span>!</p>
        <nav>
            <ul>
                <li><a href="customer_home.html">Home</a></li>
                <li><a href="#" onclick="logout()">Logout</a></li>
            </ul>
        </nav>
    </div>

    <main>
        <h2>Your Booking History</h2>
        <table id="historyTable">
            <thead>
                <tr>
                    <th>Booking ID</th>
                    <th>Date</th>
                    <th>Receiver</th>
                    <th>Status</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

        <div id="noBookings" class="hidden">No bookings found.</div>
    </main>

        <script>
        // Populate Booking History
        const historyTable = document.getElementById("historyTable");
        const tbody = historyTable.querySelector("tbody");
        const allBookingsRaw = localStorage.getItem("allBookings");
        let found = false;

        if (allBookingsRaw) {
            try {
                const bookings = JSON.parse(allBookingsRaw);

                if (Array.isArray(bookings) && bookings.length > 0) {
                    bookings.forEach(data => {
                        const bookingId = data.bookingId || "N/A";
                        const date = data.bookingDate || "Not Available";
                        const receiver = data.receiverName || "Unknown";
                        const status = data.status || "Pending";
                        const amount = data.cost || "N/A";

                        const row = `
                            <tr>
                                <td>${bookingId}</td>
                                <td>${date}</td>
                                <td>${receiver}</td>
                                <td>${status}</td>
                                <td>${amount}</td>
                            </tr>`;

                        tbody.innerHTML += row;
                    });

                    found = true;
                }
            } catch (err) {
                console.error("Failed to parse booking history:", err);
            }
        }

        if (!found) {
            document.getElementById("noBookings").classList.remove("hidden");
        }
    </script>
</body>
</html>
<!-- history.html -->